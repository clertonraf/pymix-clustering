%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v1_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v1_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v1_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v1_database_occurrenceMatrix4.txt');
%class = [0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v2_database_occurrenceMatrix3.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v2_database_occurrenceMatrix3.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v2_database_occurrenceMatrix4.txt');
%ons(1,4,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v2_database_occurrenceMatrix5.txt');
%class = [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2]'
%class2 = [2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 2, 3, 2, 2, 2, 3, 3, 3, 3, 3, 3, 2, 3, 2, 3, 2, 2, 2, 3, 3, 2, 2, 3, 2, 2, 2, 2, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v3_database_occurrenceMatrix4.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v3_database_occurrenceMatrix4.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v3_database_occurrenceMatrix5.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/alizadeh-2000-v3_database_occurrenceMatrix6.txt');
%class = [2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 2, 3, 2, 2, 2, 3, 3, 3, 3, 3, 3, 2, 3, 2, 3, 2, 2, 2, 3, 3, 2, 2, 3, 2, 2, 2, 2, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3]'

cons(1,1,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v1_database_occurrenceMatrix2.txt');
cons(1,2,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v1_database_occurrenceMatrix2.txt');
cons(1,3,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v1_database_occurrenceMatrix2.txt');
cons(1,4,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v1_database_occurrenceMatrix3.txt');
class = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]'
class2 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v2_database_occurrenceMatrix3.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v2_database_occurrenceMatrix3.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v2_database_occurrenceMatrix4.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/armstrong-2002-v2_database_occurrenceMatrix5.txt');
%class = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/bittner-2000_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/bittner-2000_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/bittner-2000_database_occurrenceMatrix2.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/bittner-2000_database_occurrenceMatrix3.txt');
%class = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/chen-2002_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/chen-2002_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/chen-2002_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/chen-2002_database_occurrenceMatrix4.txt');
%class = [1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v1_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v1_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v1_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v1_database_occurrenceMatrix4.txt');
%class = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]'
%class2 = [1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v2_database_occurrenceMatrix3.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v2_database_occurrenceMatrix3.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v2_database_occurrenceMatrix4.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/golub-1999-v2_database_occurrenceMatrix5.txt');
%class = [1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v1_database_occurrenceMatrix4.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v1_database_occurrenceMatrix4.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v1_database_occurrenceMatrix5.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v1_database_occurrenceMatrix6.txt');
%class = [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v2_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v2_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v2_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v2_database_occurrenceMatrix4.txt');
%class = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v3_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v3_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v3_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/nutt-2003-v3_database_occurrenceMatrix4.txt');
%class = [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v1_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v1_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v1_database_occurrenceMatrix2.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v1_database_occurrenceMatrix4.txt');
%class = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v2_database_occurrenceMatrix5.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v2_database_occurrenceMatrix5.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v2_database_occurrenceMatrix6.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/pomeroy-2002-v2_database_occurrenceMatrix7.txt');
%class = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/shipp-2002-v1_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/shipp-2002-v1_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/shipp-2002-v1_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/shipp-2002-v1_database_occurrenceMatrix4.txt');
%class = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/singh-2002_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/singh-2002_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/singh-2002_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/singh-2002_database_occurrenceMatrix4.txt');
%class = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v1_database_occurrenceMatrix2.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v1_database_occurrenceMatrix2.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v1_database_occurrenceMatrix3.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v1_database_occurrenceMatrix4.txt');
%class = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]'

%cons(1,1,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v2_database_occurrenceMatrix6.txt');
%cons(1,2,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v2_database_occurrenceMatrix6.txt');
%cons(1,3,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v2_database_occurrenceMatrix7.txt');
%cons(1,4,:,:) = dlmread('../../occurrenceMatrix/yeoh-2002-v2_database_occurrenceMatrix8.txt');
%class = [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]'


dim = size(cons(1,4,:,:));
dim = dim(3);

for j=1:1 
  figure
  [ordcons,clustid,ordindex,coph] = nmforderconsensus(reshape(cons(j,:,:,:),4,dim,dim),1,4); 
  
  for i=1:4
    figure
    subplot(dim+4,dim,1:dim*dim)
    pos = (1:dim)+0.5;
    %size(ordcons(j,i,:,:),52,52)
    i,j
    pcolor(-reshape(ordcons(i,:,:),dim,dim))
    set(gca,'XTick',[])
    subplot(dim+4,dim,dim*(dim+1)+1:dim*(dim+2))
    pcolor([class(ordindex(:,i))';class(ordindex(:,i))'])
    subplot(dim+4,dim,dim*(dim+3)+1:dim*(dim+4))
    pcolor([class2(ordindex(:,i))';class2(ordindex(:,i))'])

    set(gca,'YTick',pos)
    set(gca,'YTickLabel',ordindex(:,i));
    set(gca,'XTick',pos)
    set(gca,'XTickLabel',ordindex(:,i));
    set(gca,'YDir','reverse')
  end
end
